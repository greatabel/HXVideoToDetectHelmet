import cv2
# 海康
# 12345
# yxgl$666
# yxgl!123456
# yxgl123456

# 库房
# input_str= 'rtsp://admin:yxgl$666@192.168.200.182:554'
# 电气室
# input_str= 'rtsp://admin:yxgl$666@192.168.200.183:554'
# 电气室
# input_str= 'rtsp://admin:yxgl$666@192.168.200.184:554'
# input_str= 'rtsp://admin:yxgl$666@192.168.200.185:554'
# input_str= 'rtsp://admin:yxgl$666@192.168.200.186:554'
# input_str= 'rtsp://admin:yxgl$666@192.168.200.187:554'
# input_str= 'rtsp://admin:yxgl$666@192.168.200.188:554'
# input_str= 'rtsp://admin:yxgl$666@192.168.200.189:554'
# 下料口
# input_str= 'rtsp://admin:yxgl$666@192.168.200.190:554'

# camera is error 
# input_str= 'rtsp://admin:yxgl$666@192.168.200.191:554'
# input_str= 'rtsp://admin:yxgl$666@192.168.200.192:554'
# input_str= 'rtsp://admin:yxgl$666@192.168.200.193:554'
# input_str= 'rtsp://admin:yxgl$666@192.168.200.194:554'
# input_str= 'rtsp://admin:yxgl$666@192.168.200.197:554'
# input_str= 'rtsp://admin:yxgl$666@192.168.200.198:554'
# input_str= 'rtsp://admin:yxgl$666@192.168.200.202:554'
# input_str= 'rtsp://admin:yxgl$666@192.168.200.205:554'

# camear is error(error while decoding MB 58 3, bytestream -34)
# input_str= 'rtsp://admin:yxgl$666@192.168.200.203:554'

# cameara is not online
# input_str= 'rtsp://admin:yxgl$666@192.168.200.200:554'
# input_str= 'rtsp://admin:yxgl$666@192.168.200.201:554'
# input_str= 'rtsp://admin:yxgl$666@192.168.200.206:554'
# input_str= 'rtsp://admin:yxgl$666@192.168.200.207:554'
# input_str= 'rtsp://admin:yxgl$666@192.168.200.208:554'

# 下料口
# input_str= 'rtsp://admin:yxgl$666@192.168.200.195:554'
# input_str= 'rtsp://admin:yxgl$666@192.168.200.196:554'
# input_str= 'rtsp://admin:yxgl$666@192.168.200.199:554'
# 水浠下楼梯
# input_str= 'rtsp://admin:yxgl$666@192.168.200.204:554'


# input_str= 'rtsp://admin:12345@192.168.200.51:554'
# input_str= 'rtsp://admin:12345@192.168.200.52:554'
# input_str= 'rtsp://admin:12345@192.168.200.53:554'
# input_str= 'rtsp://admin:12345@192.168.200.54:554'
# input_str= 'rtsp://admin:12345@192.168.200.55:554'
# input_str= 'rtsp://admin:12345@192.168.200.56:554'

# wait
# input_str= 'rtsp://admin:yxgl$666@192.168.200.57:554'

# input_str= 'rtsp://admin:12345@192.168.200.58:554'
# input_str= 'rtsp://admin:12345@192.168.200.59:554'
# input_str= 'rtsp://admin:yxgl$666@192.168.200.60:554'
# input_str= 'rtsp://admin:12345@192.168.200.61:554'

# not online:
# input_str= 'rtsp://admin:12345@192.168.200.62:554'


# input_str= 'rtsp://admin:12345@192.168.200.63:554'
# input_str= 'rtsp://admin:12345@192.168.200.64:554'
# 大厅：
# input_str= 'rtsp://admin:12345@192.168.200.65:554'
# input_str= 'rtsp://admin:yxgl$666@192.168.200.66:554'
# input_str= 'rtsp://admin:12345@192.168.200.67:554'

# not online:
# input_str= 'rtsp://admin:12345@192.168.200.68:554'

# input_str= 'rtsp://admin:12345@192.168.200.70:554'
# input_str= 'rtsp://admin:12345@192.168.200.71:554'
# 传送带
# input_str= 'rtsp://admin:12345@192.168.200.72:554'
# 监控 煤区
# input_str= 'rtsp://admin:12345@192.168.200.73:554'
# input_str= 'rtsp://admin:12345@192.168.200.74:554'
# input_str= 'rtsp://admin:12345@192.168.200.75:554'
# 山脚下
# input_str= 'rtsp://admin:12345@192.168.200.76:554'
# 水处理
# input_str= 'rtsp://admin:12345@192.168.200.77:554'
# input_str= 'rtsp://admin:12345@192.168.200.78:554'
# input_str= 'rtsp://admin:12345@192.168.200.79:554'
# input_str= 'rtsp://admin:12345@192.168.200.80:554'
# 楼梯
# input_str= 'rtsp://admin:12345@192.168.200.81:554'
# input_str= 'rtsp://admin:12345@192.168.200.82:554'
# input_str= 'rtsp://admin:12345@192.168.200.83:554'

# not online
# input_str= 'rtsp://admin:12345@192.168.200.84:554'
# 监控室
# input_str= 'rtsp://admin:12345@192.168.200.85:554'
# input_str= 'rtsp://admin:yxgl123456@192.168.200.86:554'
# 楼道
# input_str= 'rtsp://admin:12345@192.168.200.87:554'
# 机器旁边
# input_str= 'rtsp://admin:12345@192.168.200.88:554'

#  not online
# input_str= 'rtsp://admin:12345@192.168.200.89:554'

# input_str= 'rtsp://admin:12345@192.168.200.90:554'
# 沙漏旁边
# input_str= 'rtsp://admin:12345@192.168.200.91:554'
# input_str= 'rtsp://admin:12345@192.168.200.92:554'
# 某办公室
# input_str= 'rtsp://admin:12345@192.168.200.93:554'

#not online:
# input_str= 'rtsp://admin:12345@192.168.200.94:554'
# 泥浆
# input_str= 'rtsp://admin:12345@192.168.200.95:554'
# input_str= 'rtsp://admin:12345@192.168.200.96:554'
# 水洗机器旁
# input_str= 'rtsp://admin:12345@192.168.200.97:554'
# input_str= 'rtsp://admin:12345@192.168.200.98:554'

# wait
# input_str= 'rtsp://admin:yxgl!123456@192.168.200.99:554'
# 地磅
# input_str= 'rtsp://admin:yxgl$666@192.168.200.101:554'
# input_str= 'rtsp://admin:12345@192.168.200.102:554'

# not line
# input_str= 'rtsp://admin:12345@192.168.200.103:554'

# input_str= 'rtsp://admin:12345@192.168.200.105:554'
# 江边
# input_str= 'rtsp://admin:12345@192.168.200.106:554'
# 进厂
# input_str= 'rtsp://admin:12345@192.168.200.107:554'
# input_str= 'rtsp://admin:12345@192.168.200.109:554'

# 旋转的水上
# input_str= 'rtsp://admin:yxgl$666@192.168.200.110:554'
# input_str= 'rtsp://admin:yxgl$666@192.168.200.111:554'
# 电机室
# input_str= 'rtsp://admin:yxgl$666@192.168.200.112:554'
# input_str= 'rtsp://admin:yxgl$666@192.168.200.113:554'
# input_str= 'rtsp://admin:yxgl$666@192.168.200.114:554'
input_str= 'rtsp://admin:yxgl$666@192.168.200.210:554/Streaming/Channels/1'


#rtsp://admin:yxgl!123456@10.249.181.9:554/Streaming/Channels/101
# 大华
# input_str = 'rtsp://admin:admin123@10.248.10.100:554/cam/realmonitor?channel=1&subtype=0'
#rtsp://admin:admin123@10.248.10.100:554/cam/realmonitor?channel=3&subtype=0
# input_str = 'rtsp://admin:yxgl!123456@10.249.181.9:554/Streaming/Channels/101'

# input_str = 'rtsp://admin:huaxin12345@10.248.10.43:554:554/Streaming/Channels/101'

# input_str = 'rtsp://admin:huaxin12345@10.248.10.43:554:554/Streaming/Channels/102'
import urllib



def deal_specialchar_in_url(istr):
	s = istr.find('//')
	e = istr.find('@')
	# print(s, e)
	subs = istr[s+2: e]
	name, ps = subs.split(':')
	encoded_name_ps = urllib.parse.quote_plus(name)+ ":" + urllib.parse.quote_plus(ps)
	result = 'rtsp://' + encoded_name_ps + istr[e:]
	# print(result)
	return result

addr = deal_specialchar_in_url(input_str)
print('adr', addr)

# adr = urllib.parse.quote_plus("admin")+ ":" + urllib.parse.quote_plus("hik12345+")
# print(adr)
# cap = cv2.VideoCapture("rtsp://admin:hik12345%2B@10.248.204.201:554")
# cap = cv2.VideoCapture("rtsp://"+adr + "@10.248.204.201:554")
cap = cv2.VideoCapture(addr)
count = 0

while(True):
    # Capture frame-by-frame
    ret, frame = cap.read()
    # print(frame, type(frame),'#', ret)
    if frame is not None:

        # Our operations on the frame come here
        gray = cv2.cvtColor(frame, cv2.COLOR_BGR2GRAY)

        # Display the resulting frame
        # cv2.imshow('frame',gray)
        cv2.imshow('frame',frame)
        if cv2.waitKey(1) & 0xFF == ord('q'):
            break


cap.release()
cv2.destroyAllWindows()